#include <Servo.h>

//超音波センサ　手　宣言
const int TRIG_PIN_hand_detection = 10;
const int ECHO_PIN_hand_detection = 12;
double Duration_hand;
double Distance_hand;
int Detectiondistance_cm_hand = 10;


//超音波センサ　水量　宣言
const int TRIG_PIN_water_level = 9;
const int ECHO_PIN_water_level = 8;
int times_water;
double Duration_water;
double Distance_water;
int Detectiondistance_cm_water= 10;

//サーボモータ　宣言
Servo Myservo;

//LED　宣言
int led = 4;

void setup() {
  // put your setup code here, to run once:
//超音波センサ　初期設定
  Serial.begin(9600);
  pinMode(TRIG_PIN_hand_detection, OUTPUT);
  pinMode(ECHO_PIN_hand_detection, INPUT);
  
  pinMode(TRIG_PIN_water_level, OUTPUT);
  pinMode(ECHO_PIN_water_level, INPUT);
  
//サーボモータ　初期設定
  ServoInitialSet(Myservo, 11, 0);

//LED　初期設定
  pinMode(led, OUTPUT);

}

void loop() {
  // put your main code here, to run repeatedly:
  digitalWrite(TRIG_PIN_hand_detection, LOW);
  delayMicroseconds(1);
  digitalWrite(TRIG_PIN_hand_detection, HIGH);
  delayMicroseconds(11);
  digitalWrite(TRIG_PIN_hand_detection, LOW);
  Duration_hand = pulseIn(ECHO_PIN_hand_detection, HIGH);
  if(Duration_hand > 0){
    Duration_hand = Duration_hand / 2;
    Distance_hand = Duration_hand * 340 * 100 / 1000000;
      if(Distance_hand < Detectiondistance_cm_hand){
        digitalWrite(TRIG_PIN_water_level, LOW);
        delayMicroseconds(1);
        digitalWrite(TRIG_PIN_water_level, HIGH);
        delayMicroseconds(11);
        digitalWrite(TRIG_PIN_water_level, LOW);
        Duration_water = pulseIn(ECHO_PIN_water_level, HIGH);
        if(Duration_water > 0){
          Duration_water = Duration_water / 2;
          Distance_water = Duration_water * 340 * 100 / 1000000;
            if(Distance_water < Detectiondistance_cm_water){
              Myservo.attach(11);
              Myservo.write(60);
              delay(1000);
              Myservo.write(0);
              delay(1000);
              Myservo.detach(); 
            } else{
              digitalWrite(led, HIGH);
              delay(100);
              digitalWrite(led, LOW);
            }
        }    
      }
     
  }
}

void ServoInitialSet(Servo Myservo, int AttachNumber, int SetAngle){
  Myservo.attach(AttachNumber);
  Myservo.write(SetAngle);
  delay(500);
  Myservo.detach();
  }
